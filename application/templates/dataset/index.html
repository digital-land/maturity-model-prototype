{% extends "dataset/base.html" %}
{% block page_title %}Flask prototyping index{% endblock %}
{%- from "digital-land-frontend/components/feedback-panel/macro.html" import dlFeedbackPanel %}

{% block dl_breadcrumbs %}{% endblock %}

{% block content %}

<main id="content" role="main">
  <h1 class="govuk-heading-xl">Datasets</h1>
  <p class="govuk-body-l">A place to see what datasets we have data for.</p>

  <form action="{{ url_for('base.dataset') }}">
    <div class="govuk-form-group">
      <div class="govuk-checkboxes" data-module="govuk-checkboxes">
        <div class="govuk-checkboxes__item">
          <input class="govuk-checkboxes__input" id="only_active" name="only_active" type="checkbox" value="True"{{ ' checked=checked' if only_active }}>
          <label class="govuk-label govuk-checkboxes__label" for="only_active">
            Show only active datasets
          </label>
        </div>
      </div>
    </div>
    <button class="govuk-button govuk-button--secondary" data-module="govuk-button">
      Apply filter
    </button>
  </form>

  <ul class="govuk-list">
    {% for dataset in datasets %}
    <li>
      <a href="{{ url_for('base.dataset_performance', dataset_name=dataset.dataset) }}" class="govuk-link">{{ dataset['name'] }}</a>
      {% if not dataset.dataset_active %}
        <span class="govuk-tag govuk-tag--grey">No Data</span>
      {% endif %}
    </li>
    {% endfor %}
  </ul>
</main>
{% endblock %}

{% block footer %}
<div class="dl-sticky-banner__container" data-module="sticky-banner">
    <div class="dl-sticky-banner">
        <div class="govuk-grid-row">
            <div class="govuk-grid-column-one-half">
              {# need a macro for this bit, param would set the href #}
              <a href="#btt-hook" class="govuk-link govuk-link--no-visited-state back-to-top__link">
                <svg role="presentation" focusable="false" class="back-to-top__icon" xmlns="http://www.w3.org/2000/svg" width="13" height="17" viewBox="0 0 13 17">
                    <path fill="currentColor" d="M6.5 0L0 6.5 1.4 8l4-4v12.7h2V4l4.3 4L13 6.4z"></path>
                </svg>Back to top
              </a>
            </div>
        </div>
    </div>
</div>
{{ super() }}
{% endblock %}

{% block bodyEndScripts %}
{{ super() }}
<script>
  const $bttBanner = document.querySelector('[data-module="sticky-banner"]')
  const bttComponent = new DLFrontend.BackToTop($bttBanner).init({
      endElementSelector: '.govuk-footer',
      startElementSelector: '#btt-hook',
      fixClass: 'dl-sticky-banner--fixed'
  })
</script>
{% endblock bodyEndScripts %}